---
// Get current locale from URL path or default to 'en'
const currentPathname = Astro.url.pathname;
const currentLocale = currentPathname.startsWith('/pt') ? 'pt' : 'en';
const content = await import(`../content/property/${currentLocale}.json`).then(module => module.default);
const { slides } = content.hero;

// Define slide interface
interface Slide {
    image: string;
    alt: string;
}
---

<div class="hero-slideshow relative w-full h-[65vh] max-h-[600px] overflow-hidden shadow-lg">
    <div class="swiper h-full">
        <div class="swiper-wrapper">
            {slides.map((slide: Slide) => (
                    <div class="swiper-slide">
                        <img src={slide.image} alt={slide.alt} class="w-full h-full object-cover" loading="eager" />
                    </div>
            ))}
        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>
</div>

<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
<script is:inline src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

<script is:inline>
function initSwiper() {
    if (typeof Swiper !== 'undefined' && document.querySelector('.hero-slideshow .swiper')) {
    new Swiper('.hero-slideshow .swiper', {
        loop: true,
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
            },
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
            },
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
            },
        effect: 'fade', // Optional: add a fade effect
        fadeEffect: {
        crossFade: true
        },
        });
    }
    }
document.addEventListener('astro:page-load', initSwiper);
// Also run on initial load for non-SPA navigations or direct visits
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSwiper);
    } else {
    initSwiper();
    }
</script>

<style>
.hero-slideshow .swiper-button-next,
.hero-slideshow .swiper-button-prev {
    @apply text-white bg-black bg-opacity-30 hover:bg-opacity-50 transition-opacity rounded-full w-10 h-10;
    }
.hero-slideshow .swiper-button-next::after,
.hero-slideshow .swiper-button-prev::after {
    @apply text-lg;
    }
.hero-slideshow .swiper-pagination-bullet {
    @apply bg-white bg-opacity-70 w-3 h-3;
    }
.hero-slideshow .swiper-pagination-bullet-active {
    @apply bg-brand-primary scale-125;
    }
</style>
